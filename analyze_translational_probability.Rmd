---
title: "analysis"
author: "Yiming"
date: "11/9/2018"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## read the file
```{r import-data}
df<-read.table(file = 'data/all_subjects_transitional_probability.txt', header = TRUE)
```

## linear regression of total counts
```{r linear-regression-total}
fit <- lm(total ~ Condition+Group, data=df)  # build linear regression model on full data
summary(fit)
```

# Other useful functions 
coefficients(fit) # model coefficients
confint(fit, level=0.95) # CIs for model parameters 
fitted(fit) # predicted values
residuals(fit) # residuals
anova(fit) # anova table 
vcov(fit) # covariance matrix for model parameters 
influence(fit) # regression diagnostics
# K-fold cross-validation
library(DAAG)
cv.lm(df=mydata, fit, m=3) # 3 fold cross-validation

```{r plot-total}
layout(matrix(c(1,2,3,4),2,2)) # optional 4 graphs/page 
plot(fit)
```


```{r manova-test}
# MANOVA test
res.man <- manova(cbind(AA,AB,AC,AX,BA,BB,BC,BX,CA,CB,CC,CX,XA,XB,XC,XX) ~ Condition+Group, data = df)
summary(res.man)
summary.aov(res.man)
```